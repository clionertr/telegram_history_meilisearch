# 项目产品上下文 (更新于 2025-06-02, 基于 activeContext.md)

## 1. 项目概述 (基于 activeContext.md:262-263)
本项目是一个Telegram中文消息搜索工具，包含React前端和Python后端。主要技术栈包括Telethon (用于与Telegram API交互)、FastAPI (后端框架) 和 Meilisearch (搜索引)。

## 2. 会话模块 (Sessions Feature)

### 2.1 功能概述 (基于 activeContext.md:4-9, activeContext.md:231-236)
前端"会话"界面的核心功能包括：
- **导航与页面创建**: 集成到底部导航栏，提供专门的会话页面。
- **会话列表获取与展示**: 从后端获取会话列表（ID、名称、类型、未读数、最后活动时间）并清晰展示。
- **会话头像缓存与显示**: 支持Base64头像缓存和默认头像显示，优化了加载性能。
- **分页功能**: 提供完整的分页控件和状态管理，支持前后翻页及页码显示。
- **添加到白名单功能**: 允许用户一键将会话添加到白名单，并提供操作反馈。
- **性能优化**: 通过并发加载、懒加载和多级缓存显著提升了会话加载和页面切换速度。

### 2.2 使用说明 (基于 activeContext.md:247-251)
1.  **启动后端服务**:
    ```bash
    source .venv/bin/activate
    python -m uvicorn api.main:app --reload
    ```
2.  **启动前端开发服务器**:
    ```bash
    cd frontend
    npm run dev
    ```
3.  **UserBot登录**: 首次使用时，UserBot需要登录Telegram账户。
4.  **访问会话页面**: 登录后，在前端应用的"会话"导航项即可访问会话列表。
5.  **快速浏览**: 会话的基本信息（名称、类型、未读数等）会立即显示，头像是异步加载的，不会阻塞主界面交互。页面切换实现了瞬时响应。

### 2.3 当前架构优势 (特指会话模块及相关优化) (基于 activeContext.md:380-385)
1.  **三级缓存系统**:
    *   **后端缓存**: UserBot启动时缓存会话基本信息和头像。
    *   **前端缓存**: `sessionsStore` 中维护全局会话缓存 (`allSessionsCache`)。
    *   **渐进加载**: 首次加载基本信息，头像是异步按需加载。
2.  **瞬时响应**: 由于多级缓存和前端纯内存分页，页面切换几乎无延迟 (<100ms)。
3.  **智能刷新与管理**:
    *   后端缓存支持TTL自动失效和刷新。
    *   提供API端点进行手动缓存管理（状态查看、刷新、清除头像缓存）。
4.  **优秀的用户体验**:
    *   快速的初始加载和页面切换。
    *   骨架屏、加载指示器等提供友好的加载反馈。
    *   Toast通知、触觉反馈等增强交互。
5.  **可扩展性**: 架构设计支持更大规模的会话数据处理。

## 3. 其他重要特性 (基于 activeContext.md:391-405)

### 3.1 搜索功能
-   支持对Telegram消息进行中文全文搜索。
-   使用Meilisearch作为高效的索引和搜索引。
-   支持新消息的实时同步和索引。

### 3.2 配置管理
-   提供白名单机制，允许用户指定需要索引的会话。
-   提供灵活的配置选项。
-   设计了用户友好的设置界面进行管理。

### 3.3 实时同步
-   新消息能够被实时索引。
-   消息的编辑和删除也会同步到搜索引擎。
-   支持历史消息的批量同步功能。

## 4. 技术栈总结
- **前端**: React, Vite, Tailwind CSS, Zustand (推测，基于store的使用模式)
- **后端**: Python, FastAPI, Telethon
- **搜索引擎**: Meilisearch
- **核心库**: asyncio (用于并发处理)

该项目目前在会话管理和消息搜索方面功能较为完善，并且针对性能进行了显著优化，特别是会话加载和浏览体验。